<div th:fragment="product-list" th:if="${similarProducts != null and !similarProducts.isEmpty()}">
    <div id="similarProductsCarousel" class="carousel slide carousel-dark">
        <div class="carousel-inner">

            <th:block th:each="product, iterStat : ${similarProducts}">
                <div th:if="${iterStat.index % 4 == 0}"
                     class="carousel-item"
                     th:classappend="${iterStat.first ? 'active' : ''}">

                    <div class="row">
                        <div class="col-md-3 mb-3" th:each="i : ${#numbers.sequence(0, 3)}"
                             th:if="${iterStat.index + i < similarProducts.size()}">

                            <th:block th:with="p=${similarProducts.get(iterStat.index + i)}">
                                <div class="card h-100 shadow-sm">
                                    <a th:href="@{/api/products/detail/{id}(id=${p.id})}">
                                        <img src="https://via.placeholder.com/300x200" class="card-img-top" th:alt="${p.name}">
                                    </a>
                                    <div class="card-body d-flex flex-column">
                                        <h6 class="card-title">
                                            <a th:href="@{/api/products/detail/{id}(id=${p.id})}" class="text-dark text-decoration-none" th:text="${p.name}"></a>
                                        </h6>
                                        <p class="card-text text-danger fw-bold mt-auto" th:text="${#numbers.formatDecimal(p.price, 0, 'COMMA', 0, 'POINT')} + ' â‚«'"></p>
                                    </div>
                                </div>
                            </th:block>
                        </div>
                    </div>
                </div>
            </th:block>
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#similarProductsCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#similarProductsCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span><span class="visually-hidden">Next</span>
        </button>
    </div>
</div>