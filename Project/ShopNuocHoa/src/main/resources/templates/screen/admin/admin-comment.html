<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Quản lý bình luận</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Sidebar styles -->
    <th:block th:replace="~{fragment/sidebar :: sidebar-styles}"></th:block>
</head>

<body>
<div class="container-fluid">
    <div class="row">

        <!-- SIDEBAR -->
        <div th:replace="~{fragment/sidebar :: main-sidebar}"></div>

        <!-- MAIN CONTENT -->
        <div class="col-md-9 col-lg-10 content">
            <main class="container my-5">

                <h2 class="text-center mb-4">Danh sách bình luận</h2>

                <table class="table table-bordered table-hover">
                    <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Nội dung</th>
                        <th>Sản phẩm</th>
                        <th>Hành động</th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr th:each="c : ${commentPage.content}">
                        <td th:text="${c.id}"></td>
                        <td th:text="${c.text}"></td>
                        <td th:text="${c.product != null ? c.product.name : 'N/A'}"></td>

                        <td>
                            <a class="btn btn-danger btn-sm"
                               th:href="@{/api/comments/admin(action='delete', id=${c.id})}"
                               onclick="return confirm('Bạn có chắc chắn muốn xóa bình luận này?');">
                                <i class="bi bi-trash"></i> Xóa
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <!-- PHÂN TRANG -->
                <nav aria-label="Page navigation" th:if="${commentPage.totalPages > 1}">
                    <ul class="pagination justify-content-center">

                        <!-- Trang trước -->
                        <li class="page-item" th:classappend="${commentPage.first} ? 'disabled'">
                            <a class="page-link"
                               th:href="@{/api/comments/admin(page=${commentPage.number - 1})}">
                                Trang trước
                            </a>
                        </li>

                        <!-- Danh sách trang -->
                        <li class="page-item"
                            th:each="p : ${#numbers.sequence(0, commentPage.totalPages - 1)}"
                            th:classappend="${p == commentPage.number} ? 'active'">
                            <a class="page-link"
                               th:text="${p + 1}"
                               th:href="@{/api/comments/admin(page=${p})}">
                            </a>
                        </li>

                        <!-- Trang sau -->
                        <li class="page-item" th:classappend="${commentPage.last} ? 'disabled'">
                            <a class="page-link"
                               th:href="@{/api/comments/admin(page=${commentPage.number + 1})}">
                                Trang sau
                            </a>
                        </li>

                    </ul>
                </nav>

            </main>
        </div>
    </div>
</div>

</body>
</html>
