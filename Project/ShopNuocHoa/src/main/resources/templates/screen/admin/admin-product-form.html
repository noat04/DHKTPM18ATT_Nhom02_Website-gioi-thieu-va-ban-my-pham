<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${action == 'add'} ? 'Th√™m s·∫£n ph·∫©m' : 'C·∫≠p nh·∫≠t s·∫£n ph·∫©m'">Th√™m s·∫£n ph·∫©m</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <th:block th:replace="~{fragment/sidebar :: sidebar-styles}"></th:block>
    <style>
        /* (Gi·ªØ nguy√™n ph·∫ßn style c·ªßa b·∫°n) */
        body { background-color: #f7f9fc; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .card { background-color: #ffffff; padding: 40px 30px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1); max-width: 600px; margin: 50px auto; } /* TƒÉng max-width m·ªôt ch√∫t */
        h2 { margin-bottom: 30px; font-weight: 600; color: #333; text-align: center; }
        label { font-weight: 500; margin-top: 15px; display: block; } /* Th√™m display: block */
        input[type="text"], input[type="number"], select, input[type="file"] { /* Th√™m input file */
            width: 100%; padding: 12px 15px; margin-top: 5px; border-radius: 8px; border: 1px solid #ccc; transition: all 0.3s ease;
        }
        input:focus, select:focus { outline: none; border-color: #3498db; box-shadow: 0 0 8px rgba(52, 152, 219, 0.3); }
        .btn { width: 48%; padding: 12px; border-radius: 8px; font-weight: 500; margin-top: 20px; transition: all 0.3s ease; }
        .btn-submit { background-color: #3498db; color: #fff; border: none; }
        .form-check { display: flex; align-items: center; margin-top: 10px; padding-left: 0; }
        .form-check-input { margin-top: 0; margin-right: 10px; width: 1.15em; height: 1.15em; }
        .form-check-label { margin: 0; }
        .btn-submit:hover { background-color: #2980b9; }
        .btn-cancel { background-color: #95a5a6; color: #fff; border: none; }
        .btn-cancel:hover { background-color: #7f8c8d; }
        .form-buttons { display: flex; justify-content: space-between; }

        /* CSS cho ·∫£nh preview */
        .img-preview {
            width: 100px; height: 100px; object-fit: cover;
            border-radius: 8px; border: 1px solid #ddd;
            margin-top: 10px; display: block;
        }

        @media (max-width: 576px) { .card { padding: 30px 20px; width: 90%; } .form-buttons { flex-direction: column; } .btn { width: 100%; margin-top: 10px; } }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div th:replace="~{fragment/sidebar :: main-sidebar}"></div>

        <div class="col py-5"> <div class="card">
            <h2 th:text="${action == 'add'} ? 'Th√™m s·∫£n ph·∫©m m·ªõi' : 'C·∫≠p nh·∫≠t s·∫£n ph·∫©m'">Th√™m s·∫£n ph·∫©m m·ªõi</h2>

            <form th:object="${product}" th:action="@{/api/products/form(action=${action})}"
                  method="post" enctype="multipart/form-data">

                <input type="hidden" th:if="${action == 'edit'}" th:field="*{id}" th:value="${product.id}" />

                <label for="name">T√™n s·∫£n ph·∫©m:</label>
                <input type="text" id="name" th:field="*{name}" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m" required>

                <label for="price">Gi√° (VND):</label>
                <input type="number" id="price" th:field="*{price}" placeholder="Nh·∫≠p gi√°" required step="1000" min="0">

                <label for="category">Nh√† s·∫£n xu·∫•t (Th∆∞∆°ng hi·ªáu):</label>
                <select id="category" name="categoryId" required>
                    <option value="">-- Ch·ªçn NSX --</option>
                    <th:block th:each="cat : ${categories}">
                        <option th:value="${cat.id}" th:text="${cat.name}"
                                th:selected="${product.category != null && product.category.id == cat.id}">
                            T√™n NSX
                        </option>
                    </th:block>
                </select>

                <label for="volume">Dung t√≠ch:</label>
                <select id="volume" th:field="*{volume}" required>
                    <option value="">-- Ch·ªçn dung t√≠ch --</option>
                    <option value="ML_10">10ml</option>
                    <option value="ML_30">30ml</option>
                    <option value="ML_50">50ml</option>
                    <option value="ML_75">75ml</option>
                    <option value="ML_100">100ml</option>
                    <option value="ML_150">150ml</option>
                    <option value="ML_200">200ml</option>
                </select>

                <label>Gi·ªõi t√≠nh:</label>
                <div class="d-flex gap-4 align-items-center mt-2">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" th:field="*{gender}" id="genderNam" value="NAM" required>
                        <label class="form-check-label" for="genderNam">Nam</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" th:field="*{gender}" id="genderNu" value="NU" required>
                        <label class="form-check-label" for="genderNu">N·ªØ</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" th:field="*{gender}" id="genderUnisex" value="UNISEX" required>
                        <label class="form-check-label" for="genderUnisex">Unisex</label>
                    </div>
                </div>

                <label for="quantity">S·ªë l∆∞·ª£ng t·ªìn kho:</label>
                <input type="number" id="quantity" th:field="*{quantity}" placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng" required min="0">

                <label for="imageFile">·∫¢nh s·∫£n ph·∫©m:</label>
                <div th:if="${product.id != null}" class="mb-2">
                    <img th:src="${product.getImagePath()}" alt="Current Image" class="img-preview">
                    <small class="text-muted d-block mt-1">·∫¢nh hi·ªán t·∫°i</small>
                </div>
                <input type="file" id="imageFile" name="imageFile" accept="image/*">
                <small class="text-muted fst-italic" th:if="${action == 'edit'}">* ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng mu·ªën thay ƒë·ªïi ·∫£nh.</small>

                <div class="form-check mt-4 p-3 border rounded bg-light">
                    <input class="form-check-input" type="checkbox" th:field="*{hotTrend}" id="hotTrendCheck">
                    <label class="form-check-label fw-bold" for="hotTrendCheck">
                        S·∫£n ph·∫©m N·ªïi b·∫≠t (Hot Trend) üî•
                    </label>
                </div>

                <div class="form-buttons mt-4">
                    <button type="submit" class="btn btn-submit"
                            th:text="${action == 'add'} ? 'Th√™m m·ªõi' : 'C·∫≠p nh·∫≠t'">
                        Th√™m m·ªõi
                    </button>

                    <button type="button" class="btn btn-cancel" onclick="window.location.href='/api/products/list'">
                        Quay l·∫°i
                    </button>
                </div>

            </form>
        </div>
        </div>
    </div>
</div>
</body>
</html>